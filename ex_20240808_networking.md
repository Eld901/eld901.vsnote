##### 《计算机网络 自顶层向下方法》笔记
###### 第1章 计算机网络和英特网
```
源向目的发送一个分组：  
分组L比特，传输速率R比特/秒，传输时间L/R秒。  
每`L/R`秒周期性到达1个分组，不会有排队时延。  
每`L/R`秒突发式同时到达n个分组，  
分组1无时延，分组n有`(n-1)(L/R)`秒排队时延。  
源向目的发送P个分组，经N路由器存储转发：  
即N+1条链路，端到端时延为(N+P)(L/R)秒。 

源向目的发送1个分组，经1路由器存储转发： 
即2条链路， 
L/R秒，分组到路由器；2L/R秒，分组到目的。  
如不存储，则L/R秒。  

源向目的发送3个分组，经1路由器存储转发： 
即2条链路， 
L/R秒，分组一到路由器； 
2L/R秒，分组一到目的，分组二到路由器；  
3L/R，分组二到目的，分组三到路由器；  
4L/R，分组三到目的。  

源向目的发送1个分组，经N-1路由器存储转发：  
即N条链路，端到端时延为N(L/R)秒。  

源向目的发送P个分组，经N-1路由器存储转发：  
即N条链路，端到端时延为(N+P-1)(L/R)秒。 
```
```
传640 000比特，创建电路500ms，24时隙/秒，传输速率1.536Mbps：  
电路传输速率1.536Mbps/24=64kbps，
每条电路传输时间640kb/64kbps+500ms=10.5s。  

用户10%时间产生数据速率0~100kbps，一条1Mbps链路：  
电路交换，每用户100kbps，一条链路最多支持10用户并发即最多10条电路。 
分组交换，支持35个用户时，
10或更少用户并发概率约0.9996，分组交换没有时延与电路交换一样；
超过10用户并发概率约0.0004，分组 [聚合数据速率] 超过链路输出容量，
输出队列变长，直到 [聚合输入速率] 重新低于[1Mbps]，队列变短。  
因此，分组交换一条链路至少可支持35条电路，3倍用户数也是如此。
且99.9%的概率分组交换性能与电路交换相当。  

10个用户9/10静默，1用户产生1000个1000比特突发分组：  
电路交换，若1秒=100帧，每帧10时隙，每时隙1000比特，
但用户每帧只能用1个时隙传数据，10^6比特要1000帧，10s。
分组交换，用户能够以1Mbps全部链路速率发送分组，全部发送需要1秒。 

1Mb数据，10条电路，1kbps电路速率：
电路交换，1s为100帧，1帧10时隙，1时隙1kb，1Mb要1000帧10s。
分组交换，1kbps，1Mb要1s。
同样一条连接10个电路，分组交换性能更好。
```
```
文件F比特，接收用T秒，平均吞吐量：`F/T bps`  
链路传输速率 R1,R2,...,Rn。路由器与客户速率 Rc，与服务器速 Rs  
`吞吐量` min{R1,R2,...,Rn}。min{Rc,Rs}，时间 F/min{Rc,Rs}  
每组L比特，a组，传输速率R bit/s，
分组到达速率a pkt/s，比特到达速率La bps。流量强度 La/R。  

吞吐量限制因素通常是`接入网`，还取决于干扰流量：  
客户-服务器10对，路由器与客户速率Rc，与服务器速Rs，核心中一条共同链路速率R，  
R远远大于Rc,Rs，吞吐量 min{Rc,Rs}。  
R=5Mbps与Rc=1Mbps，Rs=2Mbps同量级，公共链路平分速率，吞吐量 500kbps，  
下载瓶颈不再位于`接入网`而位于核心中`共享链路`。  
```
`因特网` `主机 端系统` `客户` `服务器` `数据中心` 互联了众多计算设备的网络   
`接入网` `通信链路` `分组交换机` `边缘路由器` 互联通信  

`ISP网络` `用户 内容提供商` `低层ISP` `第一层ISP` `高速路由器`  
`网络的网络` `客户 提供商` `PoP` `多宿` `对等` `IXP` `内容提供商`  
`接入服务` `端系统` `内容提供商`  
`住宅宽带接入` `高速局域网接入` `移动无线接入`  
`家庭` `DSL电话` `电缆电视` `FTTH AON/PON` `卫星` `拨号`  
`企业` `以太网` `WiFi 数十米` `组合`  
`广域` `蜂窝 数万米` `3G` `LTE`  
`Web站点` `视频服务器接入`  

`通信链路` `双绞铜线` `同轴电缆` `光纤` `无线局域` `卫星`  
`分组交换机` `路由器 网络核心` `链路交换机 接入网`  
`边缘路由器`：端系统到任何其他端系统的第一台路由器  

`套接字接口 API` `通信规则`  
`RFC` `因特网工程任务组IETF` `TCP/IP` `HTTP` `SMTP`  
`协议栈` `路由器3 链路交换机2 因特网5 OSI7`  
`物理1 链路2 网络3 运输4 应用5`  
`物理 数据链路 网络 运输 会话5 表示6 应用`  

`端系统 分布式应用5` `分组交换机 网络3` `加速数据交换`  
`路由选择协议` `分组` `目的IP地址` `转发表` `输出链路`  
`封装` `首部 上层有效载荷` `报文message` `报文段segment` `数据报datatgram` `帧frame`  

`存储转发` `输出队列` `排队时延` `丢包`  
`queue` `proc` `trans ` `prop` `end-end` `nodal`   
`排队` `处理` `传输 L/R` `传播  d/s` `2~3*10^8 m/s`  

`传输速率` `时隙 电路 连接` * `电路传输速率`  
`分组交换 不预留` `电路交换 预留`  
`TDM` `秒` `帧` `时隙` `比特`  
`FDM` `带宽 Hz 周期/秒`  

`僵尸网络` `恶意软件` `自我复制` `病毒` `蠕虫`  
`弱点攻击` `带宽洪泛` `连接洪泛` `DDoS`  
`嗅探分组` `IP哄骗`  

---
---
DSL  
`DSL调制解调器` `分配器` `双绞铜线` `接入复用器DSLAM`  
`0~4kHz双向~50kHz上行~1MHz下行` `不对称接入`  
`5~10英里` `1609.344 m`。  
电缆  
`电缆调制解调器` `同轴电缆` `地区枢纽` `光缆` `电缆头端CMTS`  
`混合光纤同轴HFC`  
FTTH  
`用户路由器` `光纤网络端接器ONT` `分配器` `光纤` `光纤线路端接器OLT`  
`PON` `AON` `交换因特网`  
拨号  
`家庭调制解调器` `ISP调制解调器`  
以太网  
`用户` `双绞铜线` `以太网交换机`  
`100Mbps~1Gbps用户~10Gbps服务器`  
WiFi  
`用户` `接入点` `企业网` `因特网` 
`数十米` `无线局域网LAN` `无线接入技术WiFi`    
蜂窝  
`用户` `基站` `数万米`  
`第三代无线技术3G` `长期演进LTE`  
组合  
`宽带住宅接入` `无线局域网技术`  

---
---
双绞铜线  
`电话网` `无屏蔽双绞线UTP` `局域网LAN`   
`10Mbps~10Gbps` `粗细` `距离`  
同轴电缆  
`同心结构铜导体` `电视系统` `导引型共享媒体`  
光纤  
`光脉冲` `比特` `高速` `不受电磁干扰` `光缆信号衰减低` `难窃听`  
`长途导引型传输媒体` `跨海链路` `长途电话`  
`光载波OC标准链路速率` `OC-n` `OC-1 3 12 24 48 96 192 768`  
 `n*51.8Mbps` `51.8Mbps~39.8Gbps`  
无线电信道  
`一类 1~2米` `短距` `个人设备`  
`二类 十~百米` `局域` `WiFi`  
`三类 数万米` `广域` `蜂窝接入技术`  
`同步卫星` `36000km` `280ms` 
`近地轨道LEO卫星` `多个` `覆盖区域`  

---
---
```
因特网服务提供商ISP：  
ISP网络由多台`分组交换机`和多段`通信链路`组成。  
低层ISP通过高层ISP互联，高层ISP由`高速路由器`组成。  
ISP各层独立管理，运行`IP协议`，遵循命名和地址规则。  

协议：  
控制信息在因特网中的接收和发送。  
因特网主要协议统称`TCP/IP`，`传输控制协议TCP`、`网际协议IP`    

请求评论RFC：  
即`IETF`标准文档。  
`RFC`，由`因特网工程任务组IETF`研发的一种因特网标准。  
`RFC`为解决网络协议问题，定义了`TCP` `IP` `HTTP` `SMTP`等协议。    

套接字接口：  
是发送程序必遵循的规则集合，使因特网能将数据交付给目的地。  
```
```
网络的网络：  
`接入ISP`是`客户`，`全球ISP`是`提供商`。  
网络结构1，单一的`全球ISP`。  
网络结构2，多个`全球ISP`。  
网络结构3，多个`区域ISP`与`第一ISP`。  
网络结构4，`存在点PoP`、`多宿`、`对等`、`因特网交换点`。  
网络结构5，在网络结构4顶部增加`内容提供商`，可与较低层ISP`直接互联`。  
十多个`第一层ISP`和数十万个`较低层ISP`组成`网络的网络`，  
低层与较高层ISP相连，高层ISP彼此互联，  
`用户和内容提供商`是`较低层ISP`的客户，  
`较低层ISP`是`较高层ISP`的客户。  
-----------------------------------------------
存在点PoP：  
`PoP`存在于`除了` `接入ISP`以外的等级结构所有层次。  
一个`PoP`是`提供商网络`中的一或多台`路由器`，  
`客户ISP`能够与`提供商ISP`连接，  
`客户`通过`电信提供商`租用高速链路  
将其连接到`PoP`的`路由器`。  
-----------------------------------------------
多宿：  
任何`除了` `第一层ISP`可以选择与两个及以上`提供商ISP`相连，  
一个`接入ISP`可与`两个` `区域ISP`多宿，  
也可以和`一个` `第一层ISP`多宿，  
多宿的ISP其提供商之一故障仍可继续收发分组。  
-----------------------------------------------
对等：  
位于`同级结构层次`的一对ISP能够`对等`，  
对等ISP的流量经`直接连接`而不通过上游传输，  
对等ISP不进行费用结算。  
-----------------------------------------------
因特网交换点IXP：  
`IXP`是一个汇合点，  
多个ISP在这里一起`对等`。  
```
```
分布式应用程序：  
分布式应用程序涉及多个相互交换数据的`端系统`。    
应用程序不会运行在网络核心的`分组交换机`上，  
`分组交换机`只用于加速数据交换。  

分组交换：  
端系统彼此交换报文，报文包含数据或可执行控制功能。  
报文通常会分组，通过`分组交换机` `路由器`和`链路交换机`转发，  

存储转发传输：  
`分组交换机`要先存储整个分组，才能转发。  
同理，要完成转发，才能接收下一个分组。  

转发表：  
`路由选择协议`自动设置`转发表`。  
`端系统`有`IP地址`，分组`首部`包含`目的IP地址`，  
分组到达路由器，路由器`检查目的IP` `搜索转发表` `映射出链路`  
导出分组。 
-----------------------------------------------
电路交换：  
`电路交换`在端系统通信时`预留`缓存、链路速率资源，  
发送方可以确保的`恒定速率`向接收方传送数据，  
传统电话网称建立的连接为`电路`，  
`电路`通过`频分复用FDM`或`时分复用TDM`实现。  
电路交换传输时间与链路数无关。
-----------------------------------------------
分组交换：  
`不预留`资源，  
当前分组正被传输时，其他分组需要排队等待。  
`分组交换`比`电路交换`更有效：  
`电路交换`在`静默期`的资源不能被其他连接所使用，  
打电话的人未说话时空闲链路资源不能被利用。   
-----------------------------------------------
电路交换频分复用FDM：  
链路为每条连接`专用`一个频段。  
电话网络中`带宽`即`频段宽度`常为`4kHz`即`每秒4000周期`；  
`调频无线电台`使用`FDM`来共享`88MHz~108MHz`的频谱。  
-----------------------------------------------
电路交换时分复用TDM：  
`时间`分为等期间`帧`，`帧`分为等数量`时隙`。  
每个连接占用指定`时隙`传输数据。  
```
$d_{nodal}$ = $d_{queue}$+$d_{proc}$+$d_{trans}$+$d_{prop}$  
```
排队时延：  
`毫秒到微秒`量级。 
分组交换机存储转发分组。  
路由器转发当前分组时，将转发分组进入`输出队列`，产生`排队时延`。  
`缓存队列`满，`丢包`。   
取决于先前到达分组的在缓存队列流量。  
每个分组`L比特`，传输速率为`Rbps`，  
`分组到达队列`的平均速率为`a分组/秒`即`a pkt/s`，  
`比特到达队列`的平均速率为`La bps`，  
`流量强度`为`La/R`。  
设计系统时`流量强度`不能大于1，  
La/R $\leq$ 1时，`流量强度`影响`排队时延`。  
La/R>1 时队列趋于`无限增加`，实际丢包率随`流量强度`增加而增加，
丢包分组可能基于端到端原则重传。
端到端时延不包括排队。
-----------------------------------------------
处理时延：  
`微秒`量级。  
检查首部，决定分组出链，检查差错等。  
通常是微不足道的，但对路由器最大`吞吐量`有重要影响。  
`吞吐量`是一台路由器能够转发分组的最大速率。  
-----------------------------------------------
传输时延：  
`毫秒到微秒`量级。  
分组长`L比特`，链路传输速率`Rbps`，传输时延`L/R`。  
对于`10Mbps`及更高传输速率信道如LAN可能是微不足道的，  
对于`低速调制解调器链路`发送的长因特网分组，可能`数百毫秒`。  
-----------------------------------------------
传播时延：  
广域网中`毫秒`量级。  
取决于物理媒体，  
`传播时延`=`路由器间距`/`传播速率`即`d/s`，  
`2*10^8 ~ 3*10^8 m/s`。  
对于两台位于同一大学的路由器可能是微不足道的，  
对于`同步卫星链路`互联的路由器，是`数百毫秒`。  
-----------------------------------------------
往返时延：
源向目发送分组，路由器和目的主机收到组时，向源回送报文，  
源记录了收发报文的时间和路由器名字与地址，  
以此能重建路由，确定到路由器的往返时延。  
分组n发送到路由器的往返时延可能比分组n+1的往返时延更长。  
```
```
协议分层：  
分层协议的优点是`概念化、结构化`，  
缺点是可能`冗余较低层的功能`，  
以及`违背分离层次目标`
即某层功能需要仅在其他层才出现的信息。  
-----------------------------------------------
各层的所有协议被称为`协议栈`
因特网5层协议栈：
`物理层` `链路层` `网络层` `运输层` `应用层`。  
开放系统互联OSI模型7层协议栈：  
物理层、数据链路层、网络层、运输层、会话层、表示层、应用层。  
分组交换机2、3层协议栈：  
`路由器`实现了第一到三层物理、链路、网络层。  
`链路交换机`实现了第一第二层物理、链路。  
-----------------------------------------------
应用层：  
`报文message`。  
Web文档HTTP、电子邮件SMTP、端系统文件FTP、域名系统DNS。  
-----------------------------------------------
运输层：  
`报文段segment`。  
面向连接服务TCP，可靠传输、流量控制、拥塞控制机制。  
无连接服务UDP，不可靠、无流量控制、无拥塞控制。  
-----------------------------------------------
网络层：  
`数据报datatgram`。  
网际IP协议、路由选择协议。  
网络层简称IP层。  
网络层数据报通过路由器传输，  
网络层依靠链路层的服务。  
-----------------------------------------------
链路层：  
`帧frame`。  
以太网、WiFi、电缆接入网的DOCSIS协议都是链路层协议。
网络层将数据报下传给链路层，  
链路层传给下个节点，再上传给网络层。  
链路层提供节点到节点的可靠传递，  
运输层TCP提供端到端的可靠交付。  
数据报从源到目的经多个链路，被不同链路层协议处理，  
网络层将受到来自链路层的不同服务。  
-----------------------------------------------
物理层：  
链路层将帧从节点到节点移动，  
物理层将帧中比特从节点到节点移动。  
协议仍然是链路层相关的，  
进一步与实际传输媒体双绞线、同轴电缆、光纤相关。   
-----------------------------------------------
表示层：  
使通信的应用程序能够解释交换数据的含义，  
服务包括`数据压缩`和`数据描述`。  
-----------------------------------------------
会话层：  
提供了数据交换的界定和同步功能，  
包括`建立检查点`和`恢复方案`的方法。  
-----------------------------------------------
封装：  
数据从发送端协议栈向下，  
沿中间链路层交换机和路由器协议栈上上下下，  
到达接收端协议栈。  
-----------------------------------------------
`分组=首部字段+上层有效载荷字段`：  
`应用层`报文传给`运输层`，  
`应用层报文`加上`运输层首部信息`构成`运输层报文段`，  
`运输层`报文段传给`网络层`，  
`运输层报文段`加上`网络层首部信息`构成`网络层数据报`，  
`网络层`数据报传给`链路层`，  
`网络层数据报`加上`链路层首部信息`构成`链路层帧`。  
实际封装更为复杂，一个大报文可被划分为多个运输层报文段，  
接收端要从连续的数据报中重构报文段。  
```
```
网络攻击：  
受害主机统称为`僵尸网络`，  
攻击者利用`僵尸网络控制`对目标主机  
开展`垃圾邮件分发`和`分布式拒绝服务攻击`。  
多数`恶意软件`是`自我复制`的，  
恶意软件能够以`病毒`或者`蠕虫`形式扩散。  
`病毒`需要`用户交互`来感染用户设备，  
`蠕虫`不需要显式`用户交互`就能进入设备。  
-----------------------------------------------
拒绝服务攻击DoS：  
`DoS攻击`使得网络、主机、其他基础设施不能被合法用户使用。  
`DoS`分为`弱点攻击`、`带宽洪泛`、`连接洪泛`。  
-----------------------------------------------
Dos弱点攻击：  
以适当顺序向易受攻击的应用程序或操作系统  
发送制作精细的报文，导致服务器停止、主机崩溃。  
-----------------------------------------------
Dos带宽洪泛：  
攻击者向主机发送大量分组，  
使接入链路拥塞，合法的分组无法到达服务器。  
-----------------------------------------------
Dos连接洪泛：  
攻击者在目标主机中创建大量半开或全开的TCP连接，  
主机因伪造的连接陷入困境，并停止接收合法的连接。  
-----------------------------------------------
分布式DDoS：  
攻击者控制多个受害主机组成的`僵尸网络`向目标猛烈发送流量。  
DoS带宽洪泛攻击,  
服务器接入速率为`R bps`，攻击者需要`R bps`的速率产生危害，  
如果R非常大，单一攻击源可能无法产生足够大的流量来伤害服务器，   
若单一源发出所有流量，上游路由器能够检测出攻击  
并在该流量靠近服务器之前将其阻挡。  
-----------------------------------------------
嗅探分组：  
在`无线传输设备`附近放置一台被动的接收机即`分组嗅探器`，  
该接收机就能得到传输的每个分组的副本。  
`分组嗅探器`也能够部署在`有线广播环境`  
如`LAN` `电缆接入技术`中，  
攻击者获得机构与因特网的`接入路由器`或`接入访问权`  
就能放置嗅探器获得分组副本、离线解析、提取敏感信息。  
-----------------------------------------------
IP哄骗：  
攻击者生成具有任意源地址、分组内容、目的地址的分组，传到因特网，  
接收方如路由器将其作为真实地址，执行嵌入在该分组中的命令如修改转发表。  
`端点鉴别机制`用于确保报文来自可靠源。  
```

```
用户数字线DSL接入：  
多个`DSL`与一个`分配器`相连，通过电话线即`双绞铜线`  
与`本地中心局CO`的`DSL接入复用器` `DSLAM`相连，
再接入因特网。  

`分配器` `DSLAM` 把电话和数据信号分开。  

`DSL调制解调器` 数字数据转高频音  
`不对称接入`传输速率：  
高速下行信道：50kHz~1MHz频段；  
中速上行信道：4kHz~50kHz频段；  
普通双向电话信道：0~4kHz频段。 

`DSLAM` 模拟信号转数字形式。  
-----------------------------------------------
电缆接入：  
500~5000家庭由`同轴电缆`连成一个`地区枢纽`，  
`地区枢纽`由光缆连接到`电缆头端`，再接入因特网。  

电缆接入网`共享广播媒体`。 

`电缆调制解调器` 
同 `DSL调制解调器`，`不对称`信道，速率`下行>上行`。  

`电缆调制解调器端接系统 CMTS` 
同 `DSLAM`，模拟信号转数字形式。  
-----------------------------------------------
光纤到户FTTH：  
从本地中心局直接到家庭，接入速率`每秒千兆比特`。  
被动光纤网络PON：  
用户路由器连接`光纤网络端接器ONT`，  
`ONT`由光纤连接到`分配器`，再连接到电话公司的`光纤线路端接器OLT`。  
`OLT`提供光电信号转换。  
-----------------------------------------------
卫星和拨号：  
无DSL、电缆和FTTH的环境，可用`卫星链路`接入因特网。  
电话线拨号接入同DSL模式，  
`家庭调制解调器`通过电话线连接到`ISP调制解调器`，但速率很慢。  
-----------------------------------------------
企业接入：  
`以太网接入`，  
用户由`双绞铜线`与以太网交换机相连，再与因特网相连。  
用户接入速率`100Mbps~1Gbps`，  
服务器接入速率`1Gbps~10Gbps`。 

`无线局域网LAN`，  
`无线接入技术`俗称`WiFi`，    
用户位于接入点`数十米`内，接入点与企业网相连，再与因特网相连。  
许多家庭将`宽带住宅接入`即`DSL`或`电缆`与`无线局域网技术`结合，  
组成更强大的家用网络。  
-----------------------------------------------
广域网接入：  
`移动设备`如iPhone、安卓等  
通过`蜂窝网提供商`运营的`基站`收发分组，  
用户位于基站`数万米`内。  
`第三代无线技术3G`无线广域网接入速率可达`1Mbps`。  
`长期演进LTE`源于3G，接入速率可达`10Mbps`。  
```










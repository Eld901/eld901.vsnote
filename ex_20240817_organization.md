##### 《计算机组成与设计 硬件/软件接口》笔记
###### 第一章 计算机应用的分类及其特性
```
二进制
1 kibibyte KiB 2^10 2%
2 mebibyte MiB 2^20 5%
3 gibibyte GiB 2^30 7%
4 tebibyte TiB 2^40 10%
5 pebibyte PiB 2^50 13%
6 exbiyte EiB 2^60 15%
7 zebibyte ZiB 2^70 18%
8 yobibyte YiB 2^80 21%

十进制
1 kilobyte KB 10^3
2 megabyte MB 10^6
3 terabyte TB 10^12
4 gigabyte GB 10^9
5 petabyte PB 10^15
6 exabyte EB 10^18
7 zettabyte ZB 10^21
8 yottabyte YB 10^24

```
```
$性能_{x} = 1/执行时间_{x}$  
性能_{x}/性能_{y} = 执行时间_{x}/执行时间_{y} = n  
CPU执行时间 = CPU时钟周期数 * 时钟周期  
CPU执行时间 = CPU时钟周期数 / 时钟频率 
```
`PC` `服务器`` 嵌入式计算机`  
`PMD` `云计算` `WSC` `SaaS`  

`程序性能` `算法有效性` `软件系统` `机器指令有效性`  
`I/O操作数量` `算法` `源码级语句数量`  
`机器指令数量` `编程语言` `编译器` `体系结构`  
`指令执行速度` `处理器` `存储系统`  
`I/O操作执行速度` `I/O系统`  

`8大思想`  
`1摩尔定律` `2抽象` `3大概率` `4并行`  
`5流水线` `6预测` `7存储器层次` `8冗余`  

`抽象` `软件 系统软件 硬件`  
`系统软件` `操作系统 编译程序 加载程序 汇编程序`  
`Linux iOS Windwos` 
`软硬件接口` `管理计算机资源` `输入输出` `分配内外存` `共享资源`  
`二进制位` `指令` `机器语言` `汇编语言` `汇编程序` `高级编程语言`  
`自然语言思考` `按用途进行设计` `程序相对独立于计算机`  

`硬件` `输入 输出 处理 存储`  
`设备` `输入输出` `存储器` `处理器 运算器 控制器`  


`显示器` `LCD` `动态矩阵显示`  
`像素` `位图` `帧缓冲区` `光栅`  

`存储器`  
`内存` `DRAM` `大而慢 便宜`  
`缓存` `SRAM` `小而快 较贵`  
`主要存储器` `易失性存储器 DRAM`  
`二级存储器`  
`非易失性存储器` `磁盘 服务器 5~20ms`  
`非易失性半导体存储器` `闪存 PMD 5~50ms` `100 000~1000 000`  

`指令集体系结构`  
`应用二进制接口ABI` `基本指令集 操作系统接口`  

`联网` `通信、资源共享、远距离访问`
`半导体CMOS`

`处理器 存储器`
`真空管` `晶体管` `集成电路IC`  
`超大规模集成电路VLSI` `甚大规模集成电路`  


`芯片` `硅 半导体`  
`导电体` `细铜铝线`  
`绝缘体`  `塑料、玻璃膜`  
`可控导电体或绝缘体` `开关` `晶体管`  

`芯片`  
`硅锭 直径8~12英寸 长度12~24英寸`  
`晶圆 厚不超0.1英寸` `图样化晶圆`  
`晶圆测试器` `芯片`  
`测良率` `封装` `测试` `交用户`  

`芯片数 ~= 晶圆面积/芯片面积`  
`芯片价格 = 晶圆价格/成品芯片数`  
`成品率 = 1/[1+(瑕疵数*芯片面积/2)]^2`  


`响应时间 执行时间`  
`硬盘访问` `内存访问` `I/O活动` `系统开销` `CPU执行时间`  
`吞吐率 带宽` `单位时间完成的任务数`  

`总时间` `墙上时钟时间` `响应时间` `消逝时间`  
`CPU执行时间` `用户CPU时间` `系统CPU时间`  
`系统性能 空载系统的响应时间`  
`CPU性能 用户CPU时间`  

 

```
计算机应用分类：个人计算机PC、服务器、嵌入式计算机。
服务器：功能和价格幅度大，低至千元，高至上亿。执行大负载任务，基于其他源软件修改定制。高端服务器称超级计算机。
嵌入式计算机：数量最多。运行单一或相关组应用程序，与硬件集成。以尽快速度执行有线功能，此外降低成本和功耗是最大目标。对故障敏感，面向消费者，通过简单设计来获得可靠性；大型嵌入式系统，在服务器领域采用多种冗余技术。

后PC时代（PostPC Eva）：
个人移动设备PMD代替传统PC：（Personal Mobile Device）智能手机，平板电脑。
云计算代替传统服务器：巨型数据中心，仓储规模计算机（Warehouse ScaleComputer，WSC）。云计算的软件即服务（Software as a Service，SaaS），在网络上以服务的方式提供软件和数据，登录本地客户端运行远程服务器。如Web搜索与社交网络。

简单存储模型：20世纪六七十年代，限制计算机性能的主要因素是内存容量。
现代计算机：处理器的并行性，内存的层次性，运行在PMD或云上的程序能效。

程序性能：算法有效性、软件系统、硬件机器指令有效性。
算法，决定了源码级语句数量和I/O操作数量。
编程语言、编译器、体系结构，决定了源码语句对应机器指令数量。
处理器、存储系统，决定指令执行速度。
I/O系统：决定了I/O操作执行速度。

数据级并行，C语言的子字并行；
指令级并行，多指令发射和乱序执行硬件；
存储器层次优化，阻塞cache
线程级并行，OpenMP中循环并行开发多核硬件。

计算机系统结构8大思想：
1面向摩尔定律的设计
2使用抽象简化设计
3加速大概率事件
4通过并行提高性能
5通过流水线提高性能
6通过预测提高性能
7存储器层次
8通过冗余提高可靠性

抽象：软件、系统软件、硬件
系统软件：操作系统、编译程序、加载程序、汇编程序等。
操作系统：系统软件中操作系统、编译程序对现代计算机是必须的。操作系统是软硬件接口，提供服务、监控功能，是管理计算机资源的监控程序。主要功能有，输入输出，分配内外存，共享资源。常见操作系统，Linux、iOS、Windwos。
编译程序：把高级语言编写的程序翻译成机器指令。

二进制位：计算机语言基本元素。
指令：二进制位串。
机器语言：用二进制位表示的机器指令。
汇编语言：用助记符表示的机器指令。
汇编程序：将助记符自动翻译成二进制位指令。
高级编程语言：由单词和代数符组成，由编译器转换成汇编语言。自然语言思考，按用途进行设计，程序相对独立于计算机。

硬件功能：输入数据、输出数据、处理数据、存储数据。  
硬件部件：输入输出、存储器、数据通路即运算器、控制器。运算器、控制器统称处理器。  
输入输出：关键部件，输入设备如键盘，输出设备如显示器。无线网络等设备既是输入也是输出。  
集成电路：即芯片，几十至几百晶体管连接起来的设备。  
处理器：即中央处理单元CPU。  
数据通路：执行数据运算操作。  
控制器：处理器根据程序指令指挥数据通路、存储器、I/O设备。  

显示器：I/O设备。液晶显示器（Liquid Crystal Display，LCD）。LCD含棒状液态分子团形成的转动螺旋线，控制光传输。通电时，分子棒不弯曲，偏光板间的液晶材料阻止光线通过。
液晶：不施加电压时，将背光源入射光扭转90度，显示屏呈白色；施加电压时，光线不弯曲，显示屏成黑色。
动态矩阵显示：用晶体管控制单像素上光线传输。每个像素由一个晶体管精准控制电流。彩色动态矩阵LCD中，红绿蓝屏决定颜色分量强度，每点3个晶体管。
像素：图像最小单元，屏幕由像素矩阵形成。
位图：由二进制矩阵表示的像素图。矩阵大小 1024*768~2048*1536。彩色显示器，8位一原色，每像素24位。
帧缓冲区：将显示图像保存在帧缓存区中，计算机硬件采用光栅刷新缓冲区，每个像素的二进制值以刷新频率读出到显示器。光栅扫描CRT。    
触摸屏：PC使用LCD，后PC时代通常使用电容感应，在绝缘玻璃上覆盖一层透明导体，人作为导体接触屏幕，会使屏幕的电场发生变化导致电容发生变化，允许接触多个点。  
```
```
部件：
处理器、存储器、无线通信芯片 WiFi、蓝牙、调频调谐器  
前置摄像组件 摄像头、耳机插孔、麦克风  
加速计、陀螺仪、音量控制、屏幕旋转锁定按钮  
扬声器组件  
电容性触摸屏控制器  

逻辑主板 芯片 双核ARM处理器 主存  
非易失性闪存芯片  
电源控制、I/O控制芯片  

微处理器集成电路 12.1mm*10.1mm 45nm工艺制造  
双核ARM处理器  
4通路图形处理器单元GPU  
存储器芯片  

存储器层次：DRAM、SRAM  
DRAM：动态随机访问存储器（dynamic random access memory,DRAM）。与串行访问内存即磁带不同，无论存储在什么位置，DRAM访问所需的时间基本相同。集成电路形式的存储器，可以随机访问任何地址的内存，访问时间大约为50ns。内存：大而慢，由多片DRAM组成，程序运行时的存储空间，同时存储运行时数据。  
SRAM：缓存（cache memory）小而快，处理器内部的缓存器，一般作为DRAM的缓冲。cache采用静态随机访问存储器SRAM。SRAM比DRAM快，集成度低。  

易失性存储器：主存储器，DRAM占主导，仅在加电时保存数据如内存。  
非易失性存储器：二级存储器，磁盘占主导，掉电时仍可保存数据如DVD。  
非易失性半导体存储器：闪存在个人移动设备中替代了磁盘，是PMD的二级存储标准。闪存体积、电容、可靠性、能耗方面比磁盘更好，比DRAM慢、便宜。闪存写100 000~1 000 000次后老化损坏，文件系统必须记录写操作数目，避免存储器损坏，避免移动经常使用的数据。半导体CMOS。  
主存储器：主要存储器，是易失性存储器，DRAM占主导。用于保持运行中的程序。  
二级存储器：非易失性存储器，个人移动设备PMD中一般闪存占主导，服务器中磁盘占主导。保存连词运行间的程序和数据。  
磁盘：即硬盘，非易失性二级存储器。旋转的机械设备，磁盘方位时间约5~20ms。  
闪存：非易失性半导体存储器，比磁盘块，比DRAM慢。访问时间约5~50ms。  

体系结构：即指令集体系结构。是硬件和底层软件之间的抽象接口。包含了需要编写正确运行机器语言程序所需要的全部信息，包括指令、寄存器、存储访问、I/O等。  
应用二进制接口：（Application Binary Interface,ABI），基本指令集和操作系统接口。定义了二进制层次可移植的计算机标准。  
```
```
联网计算机优点：通信、资源共享、远距离访问
以太网：最普遍的网络类型。传输距离可达1000km，传输速率可达40Gbps。
局域网：（Local Area Network,LAN），同一栋大楼内通过交换机进行连接，提供路由与安全服务。
广域网：几百千km范围内。可支持万维网作为因特网骨干，以光纤为基础向通信公司租用。

发展：
邮件介质磁带。局域网技术。广域网技术。
后PC时代的无线技术。
半导体CMOS技术。生产无线电，存储器、微处理器。

处理器和存储器
真空管、晶体管、集成电路、超大规模集成电路、甚大规模集成电路  

晶体管：（transistor）由电信号控制的开关。  
集成电路：（IC）成千上万晶体管组成的芯片。  超大规模集成电路：（very large-scale integrated circuit,VLSI）  

芯片：硅，半导体（semiconductor）
良好导电体 类似细微铜或铝线
良好绝缘体 类似塑料或玻璃膜
可控导电体或绝缘体 类似开关 晶体管


硅锭：硅晶棒，直径8~12英寸，长度12~24英寸。
晶圆：厚度不超过0.1英寸的硅锭片，用于制作芯片。
封装：合格芯片连接到I/O引脚上。
芯片制作：
硅锭，切片，晶圆，20~40生产步骤，图样化晶圆，
晶圆测试器，切片，芯片，测试良率，封装合格芯片，
测试，交给用户。

芯片成本取决于芯片面积和晶圆面积，与芯片面积一般不是线性的。
成品芯片数 = 芯片数 * 成品率
芯片数 ~= 晶圆面积/芯片面积
芯片价格 = 晶圆价格/成品芯片数
成品率 = 1/[1+(瑕疵数*芯片面积/2)]^2

```


$性能_{x} = 1/执行时间_{x}$  
性能_{x}/性能_{y} = 执行时间_{x}/执行时间_{y} = n  

A执行程序要10s，B执行程序要15s，A比B快多少？  
性能_{A}/性能_{B} = 执行时间_{B}/执行时间_{A}  
= 15/10 = 1.5  

CPU执行时间 = CPU时钟周期数 * 时钟周期  
CPU执行时间 = CPU时钟周期数 / 时钟频率  
```
计算机性能
响应时间：即执行时间，计算机完成某任务的总时间。硬盘访问、内存访问、I/O活动、系统开销、CPU执行时间等。
吞吐率：即带宽，单位时间完成的任务数量。

计算机系统中，响应时间和吞吐量相互影响。
增加吞吐率或减少响应时间以改进系统性能。
1处理器更换为更高速型号。降低时间几乎都可以增加吞吐率。
2使用多个处理器同时处理独立任务。只会增加吞吐率，不会使任务完成更快。处理更多任务时，吞吐量的增加可以缩小排队时间从而改进响应时间。  

时间度量计算机性能。
总时间 = 墙上时钟时间 = 响应时间 = 消逝时间
CPU执行时间 = 用户CPU时间 + 系统CPU时间  
用户CPU时间，用于用户程序的时间
系统CPU时间，操作系统为用户提供服务的时间

系统性能：空载系统的响应时间。
CPU性能：用户CPU时间。

时钟周期：计算机硬件设计者关心硬件完成基本功能的速度。几乎所有计算机都用时钟来驱动硬件中各种事件。时钟间隔的时间为时钟周期。它的倒数称时钟频率。如时钟周期250ps，时钟频率4GHz。
时钟长度：时钟周期持续的时间长度。


```

